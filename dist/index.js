!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws-sdk")):"function"==typeof define&&define.amd?define(["aws-sdk"],t):"object"==typeof exports?exports.library=t(require("aws-sdk")):e.library=t(e["aws-sdk"])}(global,(function(e){return t={306:e=>{e.exports=(e={})=>({region:"eu-central-1",maxRetries:5,retryDelayOptions:{base:1e3,customBackoff:(e,t)=>t.retryable?100+100*e:-1},httpOptions:{timeout:12e4,connectTimeout:5e3},logger:e.awsLog?{log(e){console.log(e)}}:{},...e.awsSdk})},493:(e,t,a)=>{const r=a(142),s=a(306),n=a(367),o=a(941),i=a(750),c=a(837);e.exports=async function(e={}){const{tableName:t,dbId:a,stateIdField:l}=e;if(!t)throw new Error("DAL Configuration Error: tableName must be defined");if(!a)throw new Error("DAL Configuration Error: dbId must be defined");if(e.memoryDal)return i(e);const d=s(e);r.config.update(d);const u=n(new r.DynamoDB);e.allowCreateTable&&!await u.isTableExists(t)&&(await u.createTable(t,c(l)),await u.waitForTableActive(t));const p=o(new r.DynamoDB.DocumentClient);return{setState:async(e,r)=>p.putItem(t,{[l]:a,state:e,updates:r}),getState:async()=>{return(e=await p.getItem(t,{[l]:a})).Item?[e.Item.state,e.Item.updates]:[null,null];var e},deleteState:async()=>p.deleteItemIfExists(t,{[l]:a}),deleteTable:async()=>u.deleteTable(t)}}},941:e=>{e.exports=function(e){const t=async(t,a)=>e.delete({TableName:t,Key:a}).promise();return{putItem:async(t,a)=>e.put({TableName:t,Item:a}).promise(),getItem:async(t,a)=>e.get({TableName:t,Key:a}).promise(),deleteItem:t,deleteItemIfExists:async(e,a)=>{try{return await t(e,a),!0}catch(e){if("ResourceNotFoundException"===e.code)return!1;throw e}}}}},367:e=>{e.exports=function(e){const t=e=>new Promise((t=>setTimeout(t,e))),a=async t=>e.describeTable({TableName:t}).promise(),r=async e=>"ACTIVE"===await(async e=>(await a(e)).Table.TableStatus)(e);return{createTable:async(t,a)=>e.createTable({...a,TableName:t}).promise(),deleteTable:async t=>e.deleteTable({TableName:t}).promise(),getTableDescriptiin:a,isTableExists:async e=>{try{return await a(e),!0}catch(e){if("ResourceNotFoundException"===e.code)return!1;throw e}},waitForTime:t,waitForTableActive:async(e,a=100)=>{let s=1;for(;!await r(e);)await t(a*s++)}}}},750:e=>{const t={},a={isTableExists:e=>!!t[e],createTable(e){t[e]={}},deleteTable(e){delete t[e]}},r={getItem:(e,a)=>t[e][a.eventId],putItem(e,a){t[e][a.eventId]=a},deleteItemIfExists(e,a){delete t[e][a.eventId]}};e.exports=async function(e={}){const{tableName:t,dbId:s,stateIdField:n}=e;return a.isTableExists(t)||a.createTable(t),{setState:async(e,a)=>r.putItem(t,{[n]:s,state:e,updates:a}),getState:async()=>{return(e=r.getItem(t,{[n]:s}))?[e.state,e.updates]:[null,null];var e},deleteState:async()=>r.deleteItemIfExists(t,{[n]:s}),deleteTable:async()=>a.deleteTable(t)}}},837:e=>{e.exports=e=>({KeySchema:[{AttributeName:e,KeyType:"HASH"}],AttributeDefinitions:[{AttributeName:e,AttributeType:"S"}],ProvisionedThroughput:{ReadCapacityUnits:10,WriteCapacityUnits:10}})},674:(e,t,a)=>{const r=a(493);e.exports=r},510:e=>{e.exports=class{constructor(e="An error occurred",t=500){this.statusCode=t,this.message=e}}},477:(e,t,a)=>{const{getCurrentState:r}=a(307),s=a(674);e.exports=async(e,{config:t})=>{const a=await s({...t,dbId:e});return r({dal:a})}},138:(e,t,a)=>{const r=a(477),s=a(450);e.exports={getState:r,updateState:s}},394:(e,t,a)=>{const{deepClone:r}=a(975),s=a(510);e.exports=async(e,{selectReducer:t,dal:a})=>{const n=t(e);if(!n)throw new s(`Invalid reducer: "${n}"`,400);const[o,i]=await a.getState(),c=await n(o||{},r(e)),l=i||[];return l.push(e),await a.setState(c,l),c}},72:e=>{e.exports=async({dal:e})=>{const[t,a]=await e.getState();return{state:t,updates:a}}},307:(e,t,a)=>{const r=a(394),s=a(72);e.exports={applyUpdate:r,getCurrentState:s}},975:e=>{const t=e=>{if(!e||"object"!=typeof e)return e;let a;const r=Array.isArray(e)?[]:{};for(const s in e)a=e[s],r[s]="object"==typeof a?t(a):a;return r};e.exports={deepClone:t}},450:(e,t,a)=>{const{applyUpdate:r}=a(307),s=a(674),n=a(510);e.exports=async(e,t,{config:a,reducers:o})=>{const i=await s({...a,dbId:t}),c=((e,t)=>a=>{const r=a[e.eventIdField],s=t[r];if(!s)throw new n(`ERROR: Invalid signal. No handler exist for "${a.signalId}"`,400);return s})(a,o);return r(e,{selectReducer:c,dal:i})}},142:t=>{"use strict";t.exports=e}},a={},function e(r){var s=a[r];if(void 0!==s)return s.exports;var n=a[r]={exports:{}};return t[r](n,n.exports,e),n.exports}(138);var t,a}));